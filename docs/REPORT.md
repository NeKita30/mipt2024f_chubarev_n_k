# Отчет

Работу выполнил: Чубарев Никита Б05-128

03.12.2024

## Задача
Создать инструмент для декодирования штрих-кодов 
различных типов с входного изображения (декодер).

Результатом работы декодера для изображения 
должна быть раскодированная информация и тип штрих-кода, 
если он присутствует на фотографии. 

Декодер должен уметь обрабатывать обширное множество типов
штрих-кодов, в том числе стандартные одномерные (EAN-13),
двумерные (QR-code, DataMatrix) и др.

Также необходимо собрать базу данных - изобрежния 
штрих-кодов разных видов.

ТЗ: [docs/TOR.md](TOR.md)

## Результат
Декодер - класс `BarcodeDecoder` (в модуле [BarcodeDecoder](../BarcodeDecoder)).
Результат его работы - namedtuple `DecodedBarCode`.

Также собраны изображения штрих-кодов ([data](../data)).

## API
У класса один метод - `decode`, который используется для расшифровки штрих-кодов. 
### Входные значения
Аргументы `decode` - изображение и (опционально) тип штих-кода.

- Изображение - `numpy.array`
- Тип штрих-кода - строка; названия типов взяты из [общей разметки](https://github.com/CD7567/mipt2024f-4-common-knowledge/blob/BarcodeClassificator/BarcodeTypes/README.md). Без указанного типа декодер будет определеять его сам (на данный момент - декодер всегда сам определяет тип) 

### Выходное значение
На выходе - namedtuple `DecodedBarCode`.

`DecodedBarCode` имеет следующие поля:

- `type` - тип штрих-кода (название в соответствии с общей разметкой)
- `data` - расшифрованная информация (`bytes`)

## Пример использования

```python
from BarcodeDecoder import BarcodeDecoder

decoder = BarcodeDecoder()
res1 = decoder.decode(img_arr1)
res2 = decoder.decode(img_arr2, "data_matrix")
```

### Запуск примера
В файле [`tests/decoder_example.py`](../tests/decoder_example.py) приведен пример использования 
декодера. Запускать скрипт нужно с `workdir` в корне 
проекта для доступа к данным.

Результат имеет вид:
```python
Decoded(data=b'5000158105324', type='ean_13')
```

## Тестирование
На данный момент проводилось [тестирование](../tests/decoder_test.py) на корректность определения
декодером типа штрих-кода.

Корректность расшифрованной информации 
проверяется при исследовании библиотек.

## Дополнительно
Используемые библиотеки: 
- pyzbar: библиотека расшифровки одномерных штрих-кодов и QR-кодов
- pylibdmtx: библиотека расшифровки дата матриц
- pyzxing: библиотека расшифровки широкого диапозона штрих-кодов

Работа библиотеки pyzbar проверенна [отдельно](https://colab.research.google.com/drive/1x_BnHwUhyHBJ7L5jDWW-krYTr8L_1RY-?usp=sharing) (ноутбук с картинками), 
выявленны диапозоны допустимых значений параметров качества входных картинок (поворот, контрастность и др.).

## Размеченные данные
В [data](../data) лежат размеченные данные - изображения штрих-кодов. 
На данный момент размечено 80 изображений.

Для разметки взят инструмент [VGG Annotator Version 2.0.12](https://www.robots.ox.ac.uk/~vgg/software/via/via_demo.html).

В [data/data_markup.json](../data/data_markup.json) находится сама разметка.


